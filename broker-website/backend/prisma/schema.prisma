// Prisma schema for BrokerHub backend
// Database: PostgreSQL

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id            Int      @id @default(autoincrement())
  email         String   @unique
  password      String
  name          String
  role          UserRole @default(BUYER)
  phone         String?
  isVerified    Boolean  @default(false)
  listings      Listing[]
  transactions  Transaction[]
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
}

enum UserRole {
  BUYER
  SELLER
  ADMIN
}

model Listing {
  id              Int            @id @default(autoincrement())
  title           String
  description     String
  price           Float
  category        Category
  location        String?
  photoUrl        String?
  type            String?
  condition       String?
  color           String?
  madeInEthiopia  Boolean        @default(false)
  bulkPrice       Float?
  negotiable      Boolean        @default(false)
  phone           String?
  name            String?
  delivery        Boolean        @default(false)
  promotion       Boolean        @default(false)
  video           String?
  status          ListingStatus  @default(ACTIVE)
  commission      Float
  owner           User           @relation(fields: [ownerId], references: [id])
  ownerId         Int
  createdAt       DateTime       @default(now())
  updatedAt       DateTime       @updatedAt
  transactions    Transaction[]
}

enum Category {
  REAL_ESTATE_SALE
  REAL_ESTATE_RENTAL
  VEHICLE
  ELECTRONICS
  SERVICES
  OTHER
}

enum ListingStatus {
  ACTIVE
  PENDING
  SOLD
  RENTED
  REMOVED
}

model Transaction {
  id            Int        @id @default(autoincrement())
  amount        Float
  commission    Float
  status        TransactionStatus
  listing       Listing    @relation(fields: [listingId], references: [id])
  listingId     Int
  buyer         User       @relation(fields: [buyerId], references: [id])
  buyerId       Int
  createdAt     DateTime   @default(now())
  updatedAt     DateTime   @updatedAt
}

enum TransactionStatus {
  PENDING
  COMPLETED
  CANCELLED
  DISPUTED
}
model Ad {
  id          Int      @id @default(autoincrement())
  title       String
  description String
  price       Float
  category    String
  imageUrl    String?
  sellerName  String
  contactInfo String
  createdAt   DateTime @default(now())
}